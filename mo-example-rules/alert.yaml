# rule name
name: alert on error_code 401

# (Required)
# Index to search, wildcard supported
index: "*"

# Type of alert.
type: any
realert:
  seconds: 0

# (Required)
# A list of Elasticsearch filters used for find events
# These filters are joined with AND and nested in a filtered query
# For more info: http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl.html
filter:
- regexp:
    openebs.error_code: ".*"

# (Required)
# The alert is use when a match is found
alert: post
http_post_url: "http://alertstore/alerts"
http_post_headers:
  x-scope-orgid: '{user_id}'
http_post_payload:
  receiver: elastalert
  status: firing
  alerts:
  - status: firing
    labels:
      alertname: '{openebs.error_key}'
      job: 'cluster_uuid_{cluster_id}'
      severity: '{openebs.severity}'
    annotations:
      SUMMARY: '{openebs.resource_name} : {log}'
    startsAt: '{@timestamp}'
    endsAt: '{@timestamp}'
